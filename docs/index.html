<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Home - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BufferMethodIntType.html">BufferMethodIntType</a><ul class='methods'><li data-type='method'><a href="BufferMethodIntType.html#decode">decode</a></li><li data-type='method'><a href="BufferMethodIntType.html#encode">encode</a></li></ul></li><li><a href="Constant.html">Constant</a><ul class='methods'><li data-type='method'><a href="Constant.html#decode">decode</a></li><li data-type='method'><a href="Constant.html#encode">encode</a></li></ul></li><li><a href="Data.html">Data</a><ul class='methods'><li data-type='method'><a href="Data.html#decode">decode</a></li><li data-type='method'><a href="Data.html#encode">encode</a></li></ul></li><li><a href="OneOf.html">OneOf</a><ul class='methods'><li data-type='method'><a href="OneOf.html#decode">decode</a></li><li data-type='method'><a href="OneOf.html#encode">encode</a></li></ul></li><li><a href="Optional.html">Optional</a><ul class='methods'><li data-type='method'><a href="Optional.html#decode">decode</a></li><li data-type='method'><a href="Optional.html#encode">encode</a></li></ul></li><li><a href="StringType.html">StringType</a><ul class='methods'><li data-type='method'><a href="StringType.html#decode">decode</a></li><li data-type='method'><a href="StringType.html#encode">encode</a></li></ul></li><li><a href="Structure.html">Structure</a><ul class='methods'><li data-type='method'><a href="Structure.html#decode">decode</a></li><li data-type='method'><a href="Structure.html#encode">encode</a></li></ul></li><li><a href="TranscodableArray.html">TranscodableArray</a><ul class='methods'><li data-type='method'><a href="TranscodableArray.html#decode">decode</a></li><li data-type='method'><a href="TranscodableArray.html#encode">encode</a></li></ul></li><li><a href="TranscodableType.html">TranscodableType</a><ul class='methods'><li data-type='method'><a href="TranscodableType.html#decode">decode</a></li><li data-type='method'><a href="TranscodableType.html#encode">encode</a></li></ul></li><li><a href="Uint8.html">Uint8</a><ul class='methods'><li data-type='method'><a href="Uint8.html#decode">decode</a></li><li data-type='method'><a href="Uint8.html#encode">encode</a></li></ul></li><li><a href="Uint32.html">Uint32</a><ul class='methods'><li data-type='method'><a href="Uint32.html#decode">decode</a></li><li data-type='method'><a href="Uint32.html#encode">encode</a></li></ul></li><li><a href="Varint.html">Varint</a><ul class='methods'><li data-type='method'><a href="Varint.html#decode">decode</a></li><li data-type='method'><a href="Varint.html#encode">encode</a></li></ul></li></ul>
</nav>

<div id="main">
    

    



    









    


    <section class="readme">
        <article><h1><a href="https://github.com/walasek/node-binary-encoder">node-binary-encoder</a> <a href="https://travis-ci.org/walasek/node-binary-encoder"><img src="https://img.shields.io/travis/walasek/node-binary-encoder.svg?style=flat-square" alt="Build Status"></a> <a href="https://www.npmjs.com/walasek/node-binary-encoder"><img src="https://img.shields.io/npm/v/binary-encoder.svg?style=flat-square" alt="Package Version"></a> <img src="https://img.shields.io/npm/l/binary-encoder.svg?style=flat-square" alt="License"> <a href="https://david-dm.org/walasek/node-binary-encoder.svg"><img src="https://david-dm.org/walasek/node-binary-encoder.svg" alt="Dependencies"></a>  <a href="https://codecov.io/gh/walasek/node-binary-encoder"><img src="https://codecov.io/gh/walasek/node-binary-encoder/branch/master/graph/badge.svg" alt="codecov"></a></h1><p>Quick and consistent binary encoding of data structures.</p>
<hr>
<h2>Goal</h2><p>Encoding data in raw buffers is a difficult task especially in terms of description of the encoding end decoding process. This project aims to deliver tools for easy description of data structures that can be encoded into raw buffers, and decoded from raw buffers and data streams.</p>
<h2>Installation</h2><p>Node <code>&gt;=8.9.0</code> is required.</p>
<pre class="prettyprint source lang-bash"><code>npm install --save binary-encoder</code></pre><p>To perform tests use:</p>
<pre class="prettyprint source lang-bash"><code>cd node_modules/binary-encoder
npm i
npm t</code></pre><p>This project also has a benchmark that you can run yourself:</p>
<pre class="prettyprint source lang-bash"><code>cd node_modules/binary-encoder
npm i
npm run benchmark</code></pre><h2>Usage</h2><p>Beware this project is still in development. There may be serious bugs or performance issues over time.</p>
<p>Documentation is available <a href="https://walasek.github.io/node-binary-encoder/">here</a>.</p>
<pre class="prettyprint source lang-javascript"><code>const bin = require('binary-encoder');

// A basic structure definition
const Person = bin.Structure({
    first_name: bin.String(),
    age: bin.Uint32(),
});

const Image = bin.Structure({
    binary: bin.Data(),
});
const Link = bin.Structure({
    url: bin.String(),
});

// A Protobuf-style OneOf union
const Attachment = bin.OneOf({
    image: Image,
    link: Link,
});

// Definitions can be nested
const MyMessage = bin.Structure({
    title: bin.String(),
    from: Person,
    to: Person,
    content: bin.String(),
    attachments: bin.Array(Attachment),
});

// Any type or definition can be encoded and decoded
const my_message = {
    title: 'binary-encoder',
    from: {first_name: 'Karol', age: 25},
    to: {first_name: 'Jon', age: 30},
    content: 'This library is awesome!',
    attachments: [
        {link: {url: 'https://github.com/walasek/node-binary-encoder'}},
    ],
};
const buffer = MyMessage.encode(my_message);
// socket.send(buffer); fs.writeFileSync(..., buffer); or something else here
// ...
// socket.on('data', ...); fs.readFilesync(...); or something else here
const message = MyMessage.decode(buffer);
// t.deepEqual(message, my_message, 'This would pass');</code></pre><h2>API</h2><h3>Basic Types</h3><table>
<thead>
<tr>
<th>Type</th>
<th>Usage</th>
<th>Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>Uint8</td>
<td>A byte of data (value range 0-255)</td>
<td>1</td>
</tr>
<tr>
<td>Uint32</td>
<td>Little-endian unsigned int (0-(2^32-1))</td>
<td>4</td>
</tr>
<tr>
<td>Varint</td>
<td>A Protobuf-style Varint, same value range as Uint32</td>
<td>1-5</td>
</tr>
</tbody>
</table>
<p>Implementing [U]Int* variants is trivial.</p>
<h3>Structures</h3><table>
<thead>
<tr>
<th>Type</th>
<th>Usage</th>
<th>Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>Structure</td>
<td>An object that maps types to keys. Order matters. All fields must be present, additional fields that are not declared earlier will not be encoded.</td>
<td>Sum of fields</td>
</tr>
<tr>
<td>Array</td>
<td>A list of values (can be of any type). Variable length by default, can be set as fixed size.</td>
<td>Sum of values (+ <em>Varint</em> size if the array is not fixed size)</td>
</tr>
<tr>
<td>OneOf</td>
<td>Protobuf-style <em>OneOf</em> which allows only one member to be encoded. Can be considered as a C-style <em>union</em>.</td>
<td><em>Varint</em> size + value size</td>
</tr>
</tbody>
</table>
<h3>Advanced Types</h3><table>
<thead>
<tr>
<th>Type</th>
<th>Usage</th>
<th>Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>Constant</td>
<td>A Uint8 constant. If attempting to decode or encode a different value an exception is thrown.</td>
<td>1 (Uint8)</td>
</tr>
<tr>
<td>Optional</td>
<td>Marks a field as optional (null if not present).</td>
<td>1 + value size (if set)</td>
</tr>
<tr>
<td>Data</td>
<td>A generic binary buffer. Equivalent to an Array of Uint8's. Can be fixed size.</td>
<td>(Array)</td>
</tr>
<tr>
<td>String</td>
<td>A UTF-8 encoded string. Equivalent to Data with some post processing. Can be fixed size.</td>
<td>(Array)</td>
</tr>
</tbody>
</table>
<h2>Benchmarks</h2><p>The following benchmark results compare Protobuf to this implementation for some basic data structure and a long string of length at least N. <code>binary-encoder-buf</code> uses a preallocated buffer for all operations.</p>
<pre class="prettyprint source"><code>protobuf x 243,121 ops/sec ±3.58% (86 runs sampled)
binary-encoder x 73,333 ops/sec ±2.17% (90 runs sampled)
binary-encoder-buf x 159,013 ops/sec ±2.34% (89 runs sampled)
json x 251,349 ops/sec ±1.19% (90 runs sampled)
Fastest Transcoding for N=10 is json

protobuf x 252,062 ops/sec ±2.13% (92 runs sampled)
binary-encoder x 71,901 ops/sec ±2.26% (92 runs sampled)
binary-encoder-buf x 158,841 ops/sec ±1.45% (93 runs sampled)
json x 224,417 ops/sec ±1.52% (94 runs sampled)
Fastest Transcoding for N=100 is protobuf

protobuf x 197,825 ops/sec ±1.72% (84 runs sampled)
binary-encoder x 65,152 ops/sec ±1.36% (90 runs sampled)
binary-encoder-buf x 138,347 ops/sec ±1.97% (92 runs sampled)
json x 119,051 ops/sec ±2.29% (89 runs sampled)
Fastest Transcoding for N=1000 is protobuf

protobuf x 67,883 ops/sec ±2.63% (74 runs sampled)
binary-encoder x 30,369 ops/sec ±4.00% (84 runs sampled)
binary-encoder-buf x 59,281 ops/sec ±1.37% (91 runs sampled)
json x 23,988 ops/sec ±0.81% (94 runs sampled)
Fastest Transcoding for N=10000 is protobuf

protobuf x 11,065 ops/sec ±4.38% (81 runs sampled)
binary-encoder x 6,191 ops/sec ±5.16% (84 runs sampled)
binary-encoder-buf x 9,975 ops/sec ±2.12% (90 runs sampled)
json x 2,642 ops/sec ±0.92% (95 runs sampled)
Fastest Transcoding for N=100000 is protobuf</code></pre><h2>Contributing</h2><p>The source is documented with JSDoc. To generate the documentation use:</p>
<pre class="prettyprint source lang-bash"><code>npm run docs</code></pre><p>Extra debugging information is printed using the <code>debug</code> module:</p>
<pre class="prettyprint source lang-bash"><code>DEBUG=binary-encoder:* npm t</code></pre><p>The documentation will be put in the new <code>docs</code> directory.</p>
<p>To introduce an improvement please fork this project, commit changes in a new branch to your fork and add a pull request on this repository pointing at your fork. Please follow these style recommendations when working on the code:</p>
<ul>
<li>Use tabs (yup).</li>
<li>Use <code>async</code>/<code>await</code> and/or <code>Promise</code> where possible.</li>
<li>Features must be properly tested.</li>
<li>New methods must be properly documented with <code>jscode</code> style comments.</li>
</ul></article>
    </section>






    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Dec 12 2018 15:14:01 GMT+0100 (Central European Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>


</body>
</html>